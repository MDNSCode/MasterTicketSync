<?xml version="1.0" encoding="UTF-8"?>
<plugin>
  <name>masterticketsync</name>
  <version>1.0.1</version>
  <license>GPLv2+</license>
  <author>Matthew Nixon</author>
  <homepage>https://github.com/MDNSCode/masterticketsync</homepage>
  <description lang="en_GB">
    Synchronizes master and slave tickets with automatic relationship tracking
    and status propagation between connected tickets.
  </description>
  
  <requirements>
    <glpi min="10.0" max="11.0" />
    <php min="7.4" />
  </requirements>

  <types>
    <type>Ticket</type>
    <type>Config</type>
  </types>

  <hooks>
    <hook name="item_add" file="hook.php" handler="handleNewTicket" type="Ticket" />
    <hook name="item_update" file="hook.php" handler="handleTicketUpdate" type="Ticket" />
    <hook name="config_page" file="hook.php" />
  </hooks>

  <database>
    <table name="glpi_plugin_masterticketsync_relations">
      <field name="id" type="autoincrement" />
      <field name="master_ticket_id" type="int" unsigned="true" />
      <field name="slave_ticket_id" type="int" unsigned="true" />
      <field name="created_at" type="timestamp" default="CURRENT_TIMESTAMP" />
      <key type="primary" field="id" />
      <key type="unique" name="master_slave" field="master_ticket_id,slave_ticket_id" />
      <key type="index" name="master" field="master_ticket_id" />
      <key type="index" name="slave" field="slave_ticket_id" />
      <foreign key="master_ticket_id" table="glpi_tickets" field="id" />
      <foreign key="slave_ticket_id" table="glpi_tickets" field="id" />
    </table>
  </database>

  <menus>
    <menu type="config" name="Master Ticket Sync" 
          directory="masterticketsync" 
          page="front/config.form.php" />
  </menus>

  <profiles>
    <profile name="PluginMasterticketsync" interface="admin" />
  </profiles>

  <tables>
    <table name="glpi_plugin_masterticketsync_relations" />
  </tables>
</plugin>
